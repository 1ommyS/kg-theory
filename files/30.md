
## 30. Поверхности Безье. Их свойства.

### 30.1. Определение

**Поверхности Безье** — это трёхмерные обобщения кривых Безье, определяемые сеткой контрольных точек. Они широко используются в 3D-моделировании, CAD-системах и графическом дизайне для создания гладких и сложных поверхностей.

### 30.2. Свойства поверхностей Безье

1. **Параметрическая форма**:
    - Определяются двумя параметрами \( u \) и \( v \), что позволяет легко интерполировать точки на поверхности.

2. **Гладкость**:
    - Обеспечивают плавные и непрерывные поверхности без резких углов.

3. **Контроль через сетку точек**:
    - Форма поверхности определяется сеткой контрольных точек, расположенных в двумерной матрице.

4. **Локальная управляемость**:
    - Изменение одной контрольной точки влияет только на часть поверхности, связанной с этой точкой.

5. **Полиорганическая форма**:
    - Позволяют создавать как простые, так и сложные органические формы.

6. **Полиномная степень**:
    - Обычно используются кубические поверхностные Безье (3-й степени по обоим параметрам), обеспечивающие высокую степень гладкости.

### 30.3. Формула поверхности Безье

Поверхность Безье определяется следующим образом:

\[
S(u, v) = \sum_{i=0}^{n} \sum_{j=0}^{m} B_{i,n}(u) B_{j,m}(v) P_{ij}, \quad u, v \in [0, 1]
\]

- \( B_{i,n}(u) \) и \( B_{j,m}(v) \) — базисные функции Безье степени \( n \) и \( m \) соответственно.
- \( P_{ij} \) — контрольные точки, расположенные в сетке \( n+1 \times m+1 \).

### 30.4. Достоинства поверхностей Безье

1. **Высокая гладкость**:
    - Обеспечивают плавные и непрерывные поверхности без резких изменений направления.

2. **Гибкость**:
    - Позволяют точно контролировать форму поверхности через сетку контрольных точек.

3. **Локальное управление**:
    - Изменение одной контрольной точки влияет только на часть поверхности, что облегчает редактирование.

4. **Универсальность**:
    - Подходят для создания как простых, так и сложных органических форм.

5. **Совместимость с CAD и 3D-моделированием**:
    - Широко используются в профессиональных инструментах для создания точных и эстетически приятных поверхностей.

### 30.5. Недостатки поверхностей Безье

1. **Сложность вычислений**:
    - Требуют значительных вычислительных ресурсов для расчёта точек поверхности, особенно при высоких степенях и больших сетках контрольных точек.

2. **Ограниченная локальная управляемость**:
    - В больших сетках изменение одной контрольной точки может влиять на значительную часть поверхности.

3. **Необходимость большого количества контрольных точек для сложных форм**:
    - Для описания сложных или детализированных поверхностей требуется множество контрольных точек, что увеличивает сложность моделирования.

4. **Отсутствие поддержки некоторых форм**:
    - Некоторые сложные геометрические формы могут быть трудно или невозможно точно описать с помощью поверхностей Безье.

### 30.6. Применение поверхностей Безье

- **3D-моделирование и анимация**: Для создания гладких и реалистичных поверхностей объектов.
- **CAD-системы**: Для проектирования точных технических деталей и конструкций.
- **Графический дизайн**: Для создания сложных и эстетически приятных поверхностей.
- **Визуальные эффекты**: В кино и играх для создания реалистичных моделей и текстур.

### 30.7. Пример реализации поверхности Безье

Реализация поверхностей Безье требует использования специализированных библиотек или API. Ниже приведён упрощённый пример использования библиотеки OpenGL для построения кубической поверхности Безье.

```cpp
#include <vector>
#include <QVector3D>
#include <cmath>

// Функция для вычисления биномиального коэффициента
int binomial(int n, int k) {
    if (k == 0 || k == n)
        return 1;
    return binomial(n - 1, k - 1) + binomial(n - 1, k);
}

// Функция для вычисления точки на кубической поверхности Безье
QVector3D bezierSurface(float u, float v, const std::vector<std::vector<QVector3D>> &controlPoints) {
    int n = controlPoints.size() - 1;
    int m = controlPoints[0].size() - 1;
    QVector3D point(0, 0, 0);

    for (int i = 0; i <= n; ++i) {
        float Bu = binomial(n, i) * pow(u, i) * pow(1 - u, n - i);
        for (int j = 0; j <= m; ++j) {
            float Bv = binomial(m, j) * pow(v, j) * pow(1 - v, m - j);
            point += Bu * Bv * controlPoints[i][j];
        }
    }

    return point;
}

int main() {
    // Определение контрольных точек для кубической поверхности Безье (4x4 сетка)
    std::vector<std::vector<QVector3D>> controlPoints = {
        { QVector3D(0, 0, 0), QVector3D(1, 0, 0), QVector3D(2, 0, 0), QVector3D(3, 0, 0) },
        { QVector3D(0, 1, 0), QVector3D(1, 1, 2), QVector3D(2, 1, 2), QVector3D(3, 1, 0) },
        { QVector3D(0, 2, 0), QVector3D(1, 2, 2), QVector3D(2, 2, 2), QVector3D(3, 2, 0) },
        { QVector3D(0, 3, 0), QVector3D(1, 3, 0), QVector3D(2, 3, 0), QVector3D(3, 3, 0) }
    };

    std::vector<QVector3D> surfacePoints;

    for (float u = 0.0f; u <= 1.0f; u += 0.05f) {
        for (float v = 0.0f; v <= 1.0f; v += 0.05f) {
            surfacePoints.push_back(bezierSurface(u, v, controlPoints));
        }
    }

    // surfacePoints содержит точки поверхности Безье
    return 0;
}
```

### 30.8. Заключение

Поверхности Безье предоставляют мощный инструмент для создания гладких и сложных трёхмерных форм. Их гибкость и точность делают их незаменимыми в профессиональных инструментах для моделирования, дизайна и визуализации, несмотря на сложности в реализации и вычислительные затраты.

---
