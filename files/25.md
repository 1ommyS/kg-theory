
## 25. Кусочные сплайновые кривые

### 25.1. Определение

**Кусочные сплайновые кривые** — это способы построения кривых, состоящих из нескольких сегментов сплайнов, соединённых между собой. Такие кривые обеспечивают высокую степень гибкости и гладкости, позволяя моделировать сложные формы и контуры.

### 25.2. Типы кусочных сплайновых кривых

1. **Cardinal сплайны**:
    - Кубические сплайны с контролируемым параметром кардинальности для регулировки формы кривой.

2. **B-сплайны**:
    - Базовые сплайны, которые не обязательно проходят через все узловые точки, обеспечивая более гладкие и гибкие формы.

3. **NURBS (Non-Uniform Rational B-Splines)**:
    - Расширение B-сплайнов с весами, позволяющее точно моделировать кривые и поверхности с различной степенью точности.

4. **Кривые Безье**:
    - Специальный тип кубических сплайнов, определяемых контрольными точками, используемый для создания гладких и контролируемых форм.

### 25.3. Свойства кусочных сплайновых кривых

1. **Гладкость**:
    - Обеспечивают плавные переходы между сегментами, что делает кривые визуально непрерывными и гладкими.

2. **Гибкость**:
    - Позволяют создавать сложные и разнообразные формы благодаря возможности регулировки параметров каждого сегмента.

3. **Локальная управляемость**:
    - Изменение одного сегмента кривой не влияет на другие, что упрощает редактирование и управление формой.

4. **Контроль над кривизной**:
    - Способность контролировать степень изгиба и натяжения кривой с помощью параметров сплайнов и контрольных точек.

### 25.4. Преимущества кусочных сплайновых кривых

1. **Высокая точность**:
    - Способны точно описывать сложные формы и контуры, включая кривые и органические линии.

2. **Плавные формы**:
    - Обеспечивают естественные и непрерывные формы без резких углов или ступенчатости.

3. **Масштабируемость**:
    - Позволяют легко изменять и модифицировать кривые без необходимости переработки всей формы.

4. **Удобство для анимации**:
    - Лёгкость в управлении движениями объектов и плавных переходах между ключевыми позициями.

### 25.5. Недостатки кусочных сплайновых кривых

1. **Сложность вычислений**:
    - Требуют сложных математических вычислений для построения и интерполяции кривых.

2. **Необходимость настройки параметров**:
    - Требуют точной настройки контрольных точек и параметров сплайнов для достижения желаемой формы.

3. **Ограниченная интерактивность**:
    - Могут быть менее гибкими при работе в реальном времени, особенно для очень сложных кривых.

4. **Потенциальные артефакты**:
    - Неправильная настройка может привести к нежелательным перегибам или неровностям.

### 25.6. Применение кусочных сплайновых кривых

- **3D-моделирование и анимация**: Для создания гладких поверхностей и движений.
- **Графический дизайн**: Для рисования плавных линий и контуров.
- **CAD-системы**: Для проектирования технических деталей и конструкций.
- **Веб-графика**: Использование векторных форматов, таких как SVG.

### 25.7. Пример реализации кусочной сплайновой кривой

```cpp
#include <vector>
#include <QVector3D>

// Структура для хранения контрольных точек
struct ControlPoint {
    QVector3D position;
};

// Функция для построения кубической сплайновой кривой между двумя контрольными точками
QVector3D cubicSpline(float t, QVector3D P0, QVector3D P1, QVector3D P2, QVector3D P3) {
    float t2 = t * t;
    float t3 = t2 * t;

    float h1 = 2*t3 - 3*t2 + 1;
    float h2 = -2*t3 + 3*t2;
    float h3 = t3 - 2*t2 + t;
    float h4 = t3 - t2;

    return h1 * P1 + h2 * P2 + h3 * (0.5f * (P2 - P0)) + h4 * (0.5f * (P3 - P1));
}

int main() {
    std::vector<ControlPoint> controlPoints = {
        { QVector3D(0, 0, 0) },
        { QVector3D(1, 2, 0) },
        { QVector3D(3, 5, 0) },
        { QVector3D(6, 5, 0) }
    };

    std::vector<QVector3D> splinePoints;

    for (size_t i = 1; i < controlPoints.size() - 2; ++i) {
        for (float t = 0.0f; t <= 1.0f; t += 0.1f) {
            splinePoints.push_back(cubicSpline(t, controlPoints[i-1].position, controlPoints[i].position, controlPoints[i+1].position, controlPoints[i+2].position));
        }
    }

    // splinePoints содержит точки кубической сплайновой кривой
    return 0;
}
```

### 25.8. Заключение

Кусочные сплайновые кривые являются мощным инструментом для создания гладких и сложных форм в компьютерной графике. Их способность точно описывать разнообразные формы делает их незаменимыми в 3D-моделировании, анимации и других областях визуализации.

---
